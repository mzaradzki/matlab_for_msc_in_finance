
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>MATLAB Tutorial 2 - Mathieu ZARADZKI</title><meta name="generator" content="MATLAB 8.2"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-10-06"><meta name="DC.source" content="m2tutorial2.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>MATLAB Tutorial 2 - Mathieu ZARADZKI</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">QUESTION 1 - Portfolio optimization 101</a></li><li><a href="#2">ANSWER TO #1</a></li><li><a href="#3">QUESTION 2 - When MATLAB is in Nice it goes surfing ... the web</a></li><li><a href="#4">ANSWER TO #2 - explanations</a></li><li><a href="#5">ANSWER TO #2 - final function code to save under "getstockdata.m"</a></li><li><a href="#6">QUESTION 3 - BETA</a></li><li><a href="#7">ANSWER TO #3 - explanations</a></li><li><a href="#8">ANSWER TO #3 - final function code to save under "greeks.m"</a></li><li><a href="#9">QUESTION 4 - ALPHA too</a></li><li><a href="#10">ANSWER TO #4 - explanations</a></li><li><a href="#11">ANSWER TO #4 - final function code to save under "greeks.m"</a></li><li><a href="#12">QUESTION 5 - Greek soup</a></li><li><a href="#13">ANSWER TO #5 - explanations</a></li><li><a href="#14">ANSWER TO #5 - final function code to save under "greeks.m"</a></li><li><a href="#15">QUESTION 6 - TS Chart</a></li><li><a href="#16">ANSWER TO #6 - simple commands to run from main window</a></li><li><a href="#17">QUESTION 7 - PDF Chart</a></li><li><a href="#18">QUESTION 8 - A simple question (for once)</a></li><li><a href="#19">ANSWER TO #8 - simple commands to run from main window</a></li><li><a href="#20">QUESTION 9 - A difficult question</a></li><li><a href="#21">QUESTION 10 - Conclusion</a></li></ul></div><h2>QUESTION 1 - Portfolio optimization 101<a name="1"></a></h2><pre>During the first class we build the mean and variance of Portfolio made
of "w" XLI and "1-w" XLF for any weight "w" between 0% and 100%
a) Re-using these can you inspect the results you had with a chart?
b) Can you suggest an optimal choice for "w" ?</pre><h2>ANSWER TO #1<a name="2"></a></h2><pre>First you get the range of portfolio means as we did in the first class
wrange = 0 : 0.01 : 1;
meanrange = wrange * mean(DXLI) + (1-wrange) * mean(DXLF);
Then you get the plot with
plot(meanrange, '*g'); % g for green and * for the data marker</pre><h2>QUESTION 2 - When MATLAB is in Nice it goes surfing ... the web<a name="3"></a></h2><pre>The four following lines are showing one possible way to load a timeserie from the internet
In this example if will load CISCO price history
stockticker = 'CSCO';
urlwrite(strcat('http://empfincourse.appspot.com/static/marketdata/stocks/',stockticker,'.csv'), stockticker);
webdata = importdata(stockticker);
prices = flipud(webdata.data(:,4));
Can you use this example to build a function that:
a) takes a stock ticker (e.g. CSCO, MCD, KO, MSFT) as an argument
b) returns a "structure" holding together the ticker, the prices, the
returns and the number of observations in the timeserie</pre><h2>ANSWER TO #2 - explanations<a name="4"></a></h2><pre>First of all to create your own function click on "New" (the + button) and then
"Function" so that you get the template.
You need to specify a name that makes sense, for example "getstockdata"
Then you "save" your file using the SAME name that is "getstockdata.m"
Then you give a name to the function argument (input) such as "ticker"
The only thing you need to change to get the required data is to replace
the name 'CSCO' from the example by your generic input name that is
ticker
You will be grouping your result in a struct, lets call it "output" and
lets specify this will be the output by modifying the first line
Lets ask for results to store the prices : output.prices = prices
Lets get the log(prices) as : output.logprices = log(prices)</pre><h2>ANSWER TO #2 - final function code to save under "getstockdata.m"<a name="5"></a></h2><pre class="language-matlab"><span class="keyword">function</span> [ output ] = getstockdata( ticker )
</pre><pre class="language-matlab">stockticker = ticker;
urlwrite(strcat(<span class="string">'http://empfincourse.appspot.com/static/marketdata/stocks/'</span>,stockticker,<span class="string">'.csv'</span>), stockticker);
webdata = importdata(stockticker); prices = flipud(webdata.data(:,4));
</pre><pre class="language-matlab">output = struct; <span class="comment">% a blanck structure to store everything</span>
</pre><pre class="language-matlab">output.ticker = ticker;
</pre><pre class="language-matlab">output.prices = prices;
</pre><pre class="language-matlab">output.logprices = log(prices);
</pre><pre class="language-matlab">output.logreturns = output.logprices(2:end) - output.logprices(1:end-1);
</pre><pre class="language-matlab"><span class="keyword">end</span>
</pre><h2>QUESTION 3 - BETA<a name="6"></a></h2><pre>Consider the following linear model for stock returns:
DStockPrices = Alpha + Beta * DIndexPrices + Epsilon (an error term)
Can you compute Beta using (only) the following:
a) the above function to load data (use 'CSCO' and 'Index_SPX500')
b) some minor algebra (i.e. a piece of paper and a pen)
c) the cov function we used during the 1st class
d) everything else that is 100% necessary but that I forgot to list</pre><h2>ANSWER TO #3 - explanations<a name="7"></a></h2><pre>First of all as this function requires data we are simply going to call
our previous function.
The point of functions is to separate tasks so as to re-use them.
We click on the "new" button (+) and then "function"
First we specify the same, for example "greeks" and save the m-file
under "greeks.m"
Remember that the beta is just cov(dstock, dindex)/var(dindex)
Also remember that Matlab "cov" function returns a full matrix</pre><h2>ANSWER TO #3 - final function code to save under "greeks.m"<a name="8"></a></h2><pre class="language-matlab"><span class="keyword">function</span> [ output ] = greeks( ticker )
</pre><pre class="language-matlab">stockdata = getstockdata(ticker);
</pre><pre class="language-matlab">indexdata = getstockdata(<span class="string">'Index_SPX500'</span>);
</pre><pre class="language-matlab">covmatrix = cov(stockdata.logreturns, indexdata.logreturns);
</pre><pre class="language-matlab">output = struct; <span class="comment">% a blanck structure to store everything</span>
</pre><pre class="language-matlab">output.ticker = ticker;
</pre><pre class="language-matlab">output.beta = covmatrix(2,1) / covmatrix(2,2); <span class="comment">% the (2,2) element is the variance !</span>
</pre><pre class="language-matlab"><span class="keyword">end</span>
</pre><h2>QUESTION 4 - ALPHA too<a name="9"></a></h2><pre>If you did not do it already answer to Q3 by building a function
Can you modify this function so that it returns BOTH the Alpha and Beta?</pre><h2>ANSWER TO #4 - explanations<a name="10"></a></h2><pre>Here we carry on working on the same function, lets not have different
functions to do similar things as we can simply group everything with a
structure !
As we have the equation beta and as the mean of "epsilon" is 0 it is
easy to deduce the alpha</pre><h2>ANSWER TO #4 - final function code to save under "greeks.m"<a name="11"></a></h2><pre class="language-matlab"><span class="keyword">function</span> [ output ] = greeks( ticker )
</pre><pre class="language-matlab">stockdata = getstockdata(ticker);
</pre><pre class="language-matlab">indexdata = getstockdata(<span class="string">'Index_SPX500'</span>);
</pre><pre class="language-matlab">covmatrix = cov(stockdata.logreturns, indexdata.logreturns);
</pre><pre class="language-matlab">output = struct; <span class="comment">% a black structure to store everything</span>
</pre><pre class="language-matlab">output.ticker = ticker;
</pre><pre class="language-matlab">output.beta = covmatrix(2,1) / covmatrix(2,2); <span class="comment">% the (2,2) element is the variance !</span>
</pre><pre class="language-matlab">output.alpha = mean(stockdata.logreturns - output.beta * indexdata.logreturns);
</pre><pre class="language-matlab"><span class="keyword">end</span>
</pre><h2>QUESTION 5 - Greek soup<a name="12"></a></h2><pre>Can you modify again the function from Q3 and Q4 so that it returns a
structure holding together the Alpha, the Beta, the Epsilon and the
Sigma of Epsilon?
Remark: the sigma is another way of refering to the standard deviation</pre><h2>ANSWER TO #5 - explanations<a name="13"></a></h2><pre>We carry on deducing the equation pieces from the previous calculations
We have beta and alpha, we get the errors (an array) by difference</pre><h2>ANSWER TO #5 - final function code to save under "greeks.m"<a name="14"></a></h2><pre class="language-matlab"><span class="keyword">function</span> [ output ] = greeks( ticker )
</pre><pre class="language-matlab">stockdata = getstockdata(ticker);
</pre><pre class="language-matlab">indexdata = getstockdata(<span class="string">'Index_SPX500'</span>);
</pre><pre class="language-matlab">covmatrix = cov(stockdata.logreturns, indexdata.logreturns);
</pre><pre class="language-matlab">output = struct; <span class="comment">% a black structure to store everything</span>
</pre><pre class="language-matlab">output.ticker = ticker;
</pre><pre class="language-matlab">output.beta = covmatrix(2,1) / covmatrix(2,2); <span class="comment">% the (2,2) element is the variance !</span>
</pre><pre class="language-matlab">output.alpha = mean(stockdata.logreturns - output.beta * indexdata.logreturns);
</pre><pre class="language-matlab">output.epsilons = stockdata.logreturns - output.beta * indexdata.logreturns - output.alpha;
</pre><pre class="language-matlab">output.sigma = std(output.epsilons);
</pre><pre class="language-matlab"><span class="keyword">end</span>
</pre><h2>QUESTION 6 - TS Chart<a name="15"></a></h2><pre>Using Q5 function and the stock ticker of your choice can you plot a
timeserie of the 'standardized' Epsilon?</pre><h2>ANSWER TO #6 - simple commands to run from main window<a name="16"></a></h2><pre class="language-matlab">msftgreeks = greeks(<span class="string">'MSFT'</span>);
plot(msftgreeks.epsilons / msftgreeks.sigma, <span class="string">'.g'</span>)
</pre><h2>QUESTION 7 - PDF Chart<a name="17"></a></h2><pre>a) Using Q6 function and the 'probplot' can you compare the standardized
Epsilon of a stock with a normal distribution pdf'?
b) Can you do this for several stock ticker and try to find one where
the chart is very different from normal and one where it is much closer
to this 'perfect' distribution?</pre><h2>QUESTION 8 - A simple question (for once)<a name="18"></a></h2><pre>What is the standard deviation of the SPX500 returns?</pre><h2>ANSWER TO #8 - simple commands to run from main window<a name="19"></a></h2><pre class="language-matlab">indexdata = getstockdata(<span class="string">'Index_SPX500'</span>);
std(indexdata.logreturns)
</pre><h2>QUESTION 9 - A difficult question<a name="20"></a></h2><pre>Lets assume that:
a) for 5 different stocks the previous "Alpha and Beta" equation holds, and that
b) for two different stocks the Epsilon' are independant from each other.
Can you use the different Beta' and Sigma' to build a Covariance matrix?</pre><h2>QUESTION 10 - Conclusion<a name="21"></a></h2><pre>Review everything we did and find a way to see if the above assumption
(Q9) is consistent with the data?</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2013b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% MATLAB Tutorial 2 - Mathieu ZARADZKI


%% QUESTION 1 - Portfolio optimization 101
%  During the first class we build the mean and variance of Portfolio made
%  of "w" XLI and "1-w" XLF for any weight "w" between 0% and 100%
%  a) Re-using these can you inspect the results you had with a chart?
%  b) Can you suggest an optimal choice for "w" ?

%% ANSWER TO #1
%  First you get the range of portfolio means as we did in the first class
%  wrange = 0 : 0.01 : 1;
%  meanrange = wrange * mean(DXLI) + (1-wrange) * mean(DXLF);
%  Then you get the plot with
%  plot(meanrange, '*g'); % g for green and * for the data marker

%% QUESTION 2 - When MATLAB is in Nice it goes surfing ... the web
%  The four following lines are showing one possible way to load a timeserie from the internet
%  In this example if will load CISCO price history
%  stockticker = 'CSCO';
%  urlwrite(strcat('http://empfincourse.appspot.com/static/marketdata/stocks/',stockticker,'.csv'), stockticker);
%  webdata = importdata(stockticker);
%  prices = flipud(webdata.data(:,4));
%  Can you use this example to build a function that:
%  a) takes a stock ticker (e.g. CSCO, MCD, KO, MSFT) as an argument
%  b) returns a "structure" holding together the ticker, the prices, the
%  returns and the number of observations in the timeserie


%% ANSWER TO #2 - explanations
%  First of all to create your own function click on "New" (the + button) and then
%  "Function" so that you get the template.
%  You need to specify a name that makes sense, for example "getstockdata"
%  Then you "save" your file using the SAME name that is "getstockdata.m"
%  Then you give a name to the function argument (input) such as "ticker"
%  The only thing you need to change to get the required data is to replace
%  the name 'CSCO' from the example by your generic input name that is
%  ticker
%  You will be grouping your result in a struct, lets call it "output" and
%  lets specify this will be the output by modifying the first line
%  Lets ask for results to store the prices : output.prices = prices
%  Lets get the log(prices) as : output.logprices = log(prices)


%% ANSWER TO #2 - final function code to save under "getstockdata.m"
%   function [ output ] = getstockdata( ticker )
% 
%   stockticker = ticker;
%   urlwrite(strcat('http://empfincourse.appspot.com/static/marketdata/stocks/',stockticker,'.csv'), stockticker);
%   webdata = importdata(stockticker); prices = flipud(webdata.data(:,4));
%     
%   output = struct; % a blanck structure to store everything
%
%   output.ticker = ticker;
%
%   output.prices = prices;
%     
%   output.logprices = log(prices);
%     
%   output.logreturns = output.logprices(2:end) - output.logprices(1:end-1);
% 
%   end


%% QUESTION 3 - BETA
%  Consider the following linear model for stock returns:
%  DStockPrices = Alpha + Beta * DIndexPrices + Epsilon (an error term)
%  Can you compute Beta using (only) the following:
%  a) the above function to load data (use 'CSCO' and 'Index_SPX500')
%  b) some minor algebra (i.e. a piece of paper and a pen)
%  c) the cov function we used during the 1st class
%  d) everything else that is 100% necessary but that I forgot to list


%% ANSWER TO #3 - explanations
%  First of all as this function requires data we are simply going to call
%  our previous function.
%  The point of functions is to separate tasks so as to re-use them.
%  We click on the "new" button (+) and then "function"
%  First we specify the same, for example "greeks" and save the m-file
%  under "greeks.m"
%  Remember that the beta is just cov(dstock, dindex)/var(dindex)
%  Also remember that Matlab "cov" function returns a full matrix


%% ANSWER TO #3 - final function code to save under "greeks.m"
%   function [ output ] = greeks( ticker )
%
%   stockdata = getstockdata(ticker);
%
%   indexdata = getstockdata('Index_SPX500');
%    
%   covmatrix = cov(stockdata.logreturns, indexdata.logreturns);
%    
%   output = struct; % a blanck structure to store everything
%    
%   output.ticker = ticker;
%    
%   output.beta = covmatrix(2,1) / covmatrix(2,2); % the (2,2) element is the variance !
%
%   end


%% QUESTION 4 - ALPHA too
%  If you did not do it already answer to Q3 by building a function
%  Can you modify this function so that it returns BOTH the Alpha and Beta?


%% ANSWER TO #4 - explanations
%  Here we carry on working on the same function, lets not have different
%  functions to do similar things as we can simply group everything with a
%  structure !
%  As we have the equation beta and as the mean of "epsilon" is 0 it is
%  easy to deduce the alpha

%% ANSWER TO #4 - final function code to save under "greeks.m"
%   function [ output ] = greeks( ticker )
%
%   stockdata = getstockdata(ticker);
%
%   indexdata = getstockdata('Index_SPX500');
%    
%   covmatrix = cov(stockdata.logreturns, indexdata.logreturns);
%    
%   output = struct; % a black structure to store everything
%    
%   output.ticker = ticker;
%    
%   output.beta = covmatrix(2,1) / covmatrix(2,2); % the (2,2) element is the variance !
%    
%   output.alpha = mean(stockdata.logreturns - output.beta * indexdata.logreturns);
%
%   end

%% QUESTION 5 - Greek soup
%  Can you modify again the function from Q3 and Q4 so that it returns a
%  structure holding together the Alpha, the Beta, the Epsilon and the
%  Sigma of Epsilon?
%  Remark: the sigma is another way of refering to the standard deviation


%% ANSWER TO #5 - explanations
%  We carry on deducing the equation pieces from the previous calculations
%  We have beta and alpha, we get the errors (an array) by difference


%% ANSWER TO #5 - final function code to save under "greeks.m"
%   function [ output ] = greeks( ticker )
%
%   stockdata = getstockdata(ticker);
%
%   indexdata = getstockdata('Index_SPX500');
%    
%   covmatrix = cov(stockdata.logreturns, indexdata.logreturns);
%    
%   output = struct; % a black structure to store everything
%    
%   output.ticker = ticker;
%    
%   output.beta = covmatrix(2,1) / covmatrix(2,2); % the (2,2) element is the variance !
%    
%   output.alpha = mean(stockdata.logreturns - output.beta * indexdata.logreturns);
%    
%   output.epsilons = stockdata.logreturns - output.beta * indexdata.logreturns - output.alpha;
%    
%   output.sigma = std(output.epsilons);
%
%   end


%% QUESTION 6 - TS Chart
%  Using Q5 function and the stock ticker of your choice can you plot a
%  timeserie of the 'standardized' Epsilon?


%% ANSWER TO #6 - simple commands to run from main window
%   msftgreeks = greeks('MSFT');
%   plot(msftgreeks.epsilons / msftgreeks.sigma, '.g')


%% QUESTION 7 - PDF Chart
%  a) Using Q6 function and the 'probplot' can you compare the standardized
%  Epsilon of a stock with a normal distribution pdf'?
%  b) Can you do this for several stock ticker and try to find one where
%  the chart is very different from normal and one where it is much closer
%  to this 'perfect' distribution?


%% QUESTION 8 - A simple question (for once)
%  What is the standard deviation of the SPX500 returns?


%% ANSWER TO #8 - simple commands to run from main window
%   indexdata = getstockdata('Index_SPX500');
%   std(indexdata.logreturns)


%% QUESTION 9 - A difficult question
%  Lets assume that:
%  a) for 5 different stocks the previous "Alpha and Beta" equation holds, and that
%  b) for two different stocks the Epsilon' are independant from each other.
%  Can you use the different Beta' and Sigma' to build a Covariance matrix?


%% QUESTION 10 - Conclusion
%  Review everything we did and find a way to see if the above assumption
%  (Q9) is consistent with the data?



##### SOURCE END #####
--></body></html>