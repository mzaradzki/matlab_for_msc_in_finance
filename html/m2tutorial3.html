
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>MATLAB Tutorial 3 - Mathieu ZARADZKI</title><meta name="generator" content="MATLAB 8.2"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-10-19"><meta name="DC.source" content="m2tutorial3.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>MATLAB Tutorial 3 - Mathieu ZARADZKI</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">QUESTION 1 - Gaussian distribution chart and integral</a></li><li><a href="#2">ANSWER to #1</a></li><li><a href="#3">QUESTION 2 - Data manipulation</a></li><li><a href="#4">ANSWER to #2</a></li><li><a href="#5">QUESTION 3 - Counting occurences</a></li><li><a href="#6">ANSWER to #3</a></li><li><a href="#7">QUESTION 4 - If Warren Buffet was broke ...</a></li><li><a href="#8">QUESTION 5 - The portfolio universe</a></li><li><a href="#9">ANSWER to #5</a></li><li><a href="#10">QUESTION 6 - Tracking the index</a></li><li><a href="#11">QUESTION 7 - Simulating a t-distribution</a></li><li><a href="#12">ANSWER to #7</a></li><li><a href="#13">QUESTION 8 - A difficult question ... so difficult we postponed it from lesson 1</a></li><li><a href="#14">QUESTION 9 - Working as a Quant Analyst</a></li></ul></div><h2>QUESTION 1 - Gaussian distribution chart and integral<a name="1"></a></h2><pre>Using the plot function draw a chart of the gaussian distribution between -4 and 4
Using Matlab "integral" function compute the probability of X&gt;2
Turn this into a function and compare with the "cdf" function</pre><h2>ANSWER to #1<a name="2"></a></h2><pre class="codeinput">Xs = [- 4 : 0.01 : 4];

Ys = normpdf(Xs, 0, 1);

plot(Xs, Ys);

myfun = @(x) normpdf(x, 0, 1);

probAbove2 = integral(myfun, 2, Inf)

probAboveX = @(X) integral(myfun, X, Inf);

probAboveX(2)

benchmark = 1 - normcdf(2, 0, 1)
</pre><pre class="codeoutput">
probAbove2 =

    0.0228


ans =

    0.0228


benchmark =

    0.0228

</pre><img vspace="5" hspace="5" src="m2tutorial3_01.png" alt=""> <h2>QUESTION 2 - Data manipulation<a name="3"></a></h2><pre>We saw how to load data from the internet and save it into a structure
Do this for 5 different stocks and form a matrix using their price log-return vectors
Also load the index and append it as a 6th column</pre><h2>ANSWER to #2<a name="4"></a></h2><pre class="codeinput">mcd = getstockdata(<span class="string">'MCD'</span>);
intc = getstockdata(<span class="string">'INTC'</span>);
jpm = getstockdata(<span class="string">'JPM'</span>);
ko = getstockdata(<span class="string">'KO'</span>);
msft = getstockdata(<span class="string">'MSFT'</span>);

logreturns = [mcd.logreturns, intc.logreturns, jpm.logreturns, ko.logreturns, msft.logreturns];
</pre><h2>QUESTION 3 - Counting occurences<a name="5"></a></h2><pre>Count how often at least one of the stocks lost (resp. gained) 2pct
Count how often at all of them lost (resp. gained) 2pct
TIP: you can do this without any loop
TIP: sorry to insist but no-loop please
TIP: try this command "[1 -2 4 2 5]&gt;3"</pre><h2>ANSWER to #3<a name="6"></a></h2><pre class="codeinput">losstest = (logreturns &lt;= -0.02);
losscount = sum(losstest'); <span class="comment">% a great trick</span>
losscount = losscount';

sum(losscount &gt; 0) <span class="comment">% at least ONE of them</span>
sum(losscount == 5) <span class="comment">% ALL of them</span>

gaintest = (logreturns &gt;= +0.02);
gaincount = sum(gaintest'); <span class="comment">% a great trick</span>
gaincount = gaincount';

sum(gaincount &gt; 0) <span class="comment">% at least ONE of them</span>
sum(gaincount == 5) <span class="comment">% ALL of them</span>
</pre><pre class="codeoutput">
ans =

   576


ans =

    22


ans =

   614


ans =

    14

</pre><h2>QUESTION 4 - If Warren Buffet was broke ...<a name="7"></a></h2><pre>... he would probably it try all over again
Berkshire sold large Stock Index indices betting that ALL major indices
would perform well over the long run
How would you simulate the behaviour of your 5 stocks if you could only
simulate a number between 0 and NbObs (NbObs being the size of your sample)?
Could you then price Berkshire trade over 100 time steps?
TIP: you can use "randi([1 20])" to simulate integers between 1 and 20</pre><h2>QUESTION 5 - The portfolio universe<a name="8"></a></h2><pre>A portfolio is determined by its holding weights
Lets consider the universe of long only portfolio that are not
leveraged
We want to represent each of them of a chart of (x=std, y=mean) ...
... but there is an infinite number of them?
A large number will be enough for today e.g. 1000 portfolios
TIP: you can use "rand(5,1)" to simulate a set of 5 numbers from 0 to 1</pre><h2>ANSWER to #5<a name="9"></a></h2><pre class="codeinput">nbsimulations = 500; <span class="comment">% set here a high number like 10000</span>

means = zeros(nbsimulations, 1);
stds = zeros(nbsimulations, 1);

<span class="keyword">for</span> i = 1 : nbsimulations
    weights = rand(5, 1);
    weights = weights / sum(weights);
    portfoliologreturns = logreturns * weights;
    means(i) = mean(portfoliologreturns);
    stds(i) = std(portfoliologreturns);
<span class="keyword">end</span>

plot(stds, means, <span class="string">'*b'</span>);
</pre><img vspace="5" hspace="5" src="m2tutorial3_02.png" alt=""> <h2>QUESTION 6 - Tracking the index<a name="10"></a></h2><pre>With the 5 stocks you selected, can you find a long only portfolio that
tracks the best the index?
Can you use a chart to see how it compares to other portfolios?</pre><h2>QUESTION 7 - Simulating a t-distribution<a name="11"></a></h2><pre>Matlab "rand" command returns (uniformly) a number between 0 and 1
Can you use this to simulate a t-distribution?
Please write a function for this
TIP: check out Matlab functions "tcdf" and "tinv"</pre><h2>ANSWER to #7<a name="12"></a></h2><pre>The key is to notice that tinv( rand ) will be a t-distribution!
This is because the tinv is the converse of tcdf.
And a CDF is a mapping from the distribution to the [0, 1] range.</pre><pre class="codeinput">randt = @(dof) tinv(rand(1,1), dof);

randt(10) <span class="comment">% a 1st simulation</span>
randt(10) <span class="comment">% a 2nd simulation</span>
randt(10) <span class="comment">% a 3rd simulation</span>
randt(10) <span class="comment">% a 4th simulation</span>
</pre><pre class="codeoutput">
ans =

   -0.1056


ans =

    1.0715


ans =

    0.0857


ans =

   -1.5916

</pre><h2>QUESTION 8 - A difficult question ... so difficult we postponed it from lesson 1<a name="13"></a></h2><pre>Lets assume that:
a) for 5 different stocks the previous "Alpha and Beta" equation holds, and that
b) for two different stocks the Epsilon' are independant from each other.
Can you use the different Beta' and Sigma' to build a "model" covariance matrix?</pre><h2>QUESTION 9 - Working as a Quant Analyst<a name="14"></a></h2><pre>In the case of a 2 stock portfolio allocation, can you optimize the
weights using a function maximization of the Sharpe ratio?
TIP: you can use "fminsearch" function</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2013b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% MATLAB Tutorial 3 - Mathieu ZARADZKI


%% QUESTION 1 - Gaussian distribution chart and integral
%  Using the plot function draw a chart of the gaussian distribution between -4 and 4
%  Using Matlab "integral" function compute the probability of X>2
%  Turn this into a function and compare with the "cdf" function


%% ANSWER to #1

Xs = [- 4 : 0.01 : 4];

Ys = normpdf(Xs, 0, 1);

plot(Xs, Ys);

myfun = @(x) normpdf(x, 0, 1);

probAbove2 = integral(myfun, 2, Inf)

probAboveX = @(X) integral(myfun, X, Inf);

probAboveX(2)

benchmark = 1 - normcdf(2, 0, 1)


%% QUESTION 2 - Data manipulation
%  We saw how to load data from the internet and save it into a structure
%  Do this for 5 different stocks and form a matrix using their price log-return vectors
%  Also load the index and append it as a 6th column


%% ANSWER to #2
mcd = getstockdata('MCD');
intc = getstockdata('INTC');
jpm = getstockdata('JPM');
ko = getstockdata('KO');
msft = getstockdata('MSFT');

logreturns = [mcd.logreturns, intc.logreturns, jpm.logreturns, ko.logreturns, msft.logreturns];


%% QUESTION 3 - Counting occurences
%  Count how often at least one of the stocks lost (resp. gained) 2pct
%  Count how often at all of them lost (resp. gained) 2pct
%  TIP: you can do this without any loop
%  TIP: sorry to insist but no-loop please
%  TIP: try this command "[1 -2 4 2 5]>3"


%% ANSWER to #3

losstest = (logreturns <= -0.02);
losscount = sum(losstest'); % a great trick
losscount = losscount';

sum(losscount > 0) % at least ONE of them
sum(losscount == 5) % ALL of them

gaintest = (logreturns >= +0.02);
gaincount = sum(gaintest'); % a great trick
gaincount = gaincount';

sum(gaincount > 0) % at least ONE of them
sum(gaincount == 5) % ALL of them

%% QUESTION 4 - If Warren Buffet was broke ...
%  ... he would probably it try all over again
%  Berkshire sold large Stock Index indices betting that ALL major indices
%  would perform well over the long run
%  How would you simulate the behaviour of your 5 stocks if you could only
%  simulate a number between 0 and NbObs (NbObs being the size of your sample)?
%  Could you then price Berkshire trade over 100 time steps?
%  TIP: you can use "randi([1 20])" to simulate integers between 1 and 20


%% QUESTION 5 - The portfolio universe
%  A portfolio is determined by its holding weights
%  Lets consider the universe of long only portfolio that are not
%  leveraged
%  We want to represent each of them of a chart of (x=std, y=mean) ...
%  ... but there is an infinite number of them?
%  A large number will be enough for today e.g. 1000 portfolios
%  TIP: you can use "rand(5,1)" to simulate a set of 5 numbers from 0 to 1


%% ANSWER to #5

nbsimulations = 500; % set here a high number like 10000

means = zeros(nbsimulations, 1);
stds = zeros(nbsimulations, 1);

for i = 1 : nbsimulations
    weights = rand(5, 1);
    weights = weights / sum(weights);
    portfoliologreturns = logreturns * weights;
    means(i) = mean(portfoliologreturns);
    stds(i) = std(portfoliologreturns);
end

plot(stds, means, '*b');

%% QUESTION 6 - Tracking the index
%  With the 5 stocks you selected, can you find a long only portfolio that
%  tracks the best the index?
%  Can you use a chart to see how it compares to other portfolios?


%% QUESTION 7 - Simulating a t-distribution
%  Matlab "rand" command returns (uniformly) a number between 0 and 1
%  Can you use this to simulate a t-distribution?
%  Please write a function for this
%  TIP: check out Matlab functions "tcdf" and "tinv"


%% ANSWER to #7
%  The key is to notice that tinv( rand ) will be a t-distribution!
%  This is because the tinv is the converse of tcdf.
%  And a CDF is a mapping from the distribution to the [0, 1] range.

randt = @(dof) tinv(rand(1,1), dof);

randt(10) % a 1st simulation
randt(10) % a 2nd simulation
randt(10) % a 3rd simulation
randt(10) % a 4th simulation



%% QUESTION 8 - A difficult question ... so difficult we postponed it from lesson 1
%  Lets assume that:
%  a) for 5 different stocks the previous "Alpha and Beta" equation holds, and that
%  b) for two different stocks the Epsilon' are independant from each other.
%  Can you use the different Beta' and Sigma' to build a "model" covariance matrix?


%% QUESTION 9 - Working as a Quant Analyst
%  In the case of a 2 stock portfolio allocation, can you optimize the
%  weights using a function maximization of the Sharpe ratio?
%  TIP: you can use "fminsearch" function


##### SOURCE END #####
--></body></html>